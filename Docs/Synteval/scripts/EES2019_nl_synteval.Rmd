---
title: Summary of Synthetic Variables Estimation 
subtitle: EES 2019 Voter Study (Danish, Estonian, German, Luxembourgian, Maltese, Netherlands, Spanish and British (UK) samples)
author: Wilhelmine Haeussling
date: 15.11.2021 
toc: false
output: 
  bookdown::pdf_document2:
    includes:
      in_header: eval_header.tex
urlcolor: RedOrange
---

```{r echo=FALSE, warning=FALSE, message=FALSE}

# Load 'here' for sourcing # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - #
library('here')

# Source the general workflow # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -#
source(here('Scripts', 'synteval_scripts', 'Synteval_gen.R'))

```

\newpage
# Netherlands

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Dutch synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval_scripts', 'country_spec_scripts', 'EES2019_nl_synteval.R'))

```

Synthetic variables have been estimated for nine of 16 Dutch parties available in the original 
2019 EES Dutch voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_nl}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Dutch relevant parties \\label{table:relprty_tab_nl}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_nl}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that in 0 cases out of 9 null models perform better than full ones (see Table 
\ref{table:ols_aic_nl}).

```{r echo=FALSE, message=FALSE, warning=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_nl}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

Full logit models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_logit_nl}). 

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and null models shows that in 4 cases out of 9 null models perform better than full ones (see Table
\ref{table:logit_aic_nl}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_nl}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) 

```


```{r, results='asis', echo=F}

stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_nl',
                     type = 'latex',
                     column.labels = c("2001", "2002", "2003", "2004", "2005", "2006", "2007", 
                                       "2008", "2012"),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps')

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_nl',
                       type = 'latex',
                       column.labels = c("2001", "2002", "2003", "2004", "2005", "2006", "2007", 
                                       "2008", "2012"),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>% 
  gsub('Model 9', 'Model 18',.) %>% 
  gsub('Model 8', 'Model 17',.) %>%
  gsub('Model 7', 'Model 16',.) %>% 
  gsub('Model 6', 'Model 15',.) %>% 
  gsub('Model 5', 'Model 14',.) %>% 
  gsub('Model 4', 'Model 13',.) %>% 
  gsub('Model 3', 'Model 12',.) %>% 
  gsub('Model 2', 'Model 11',.) %>% 
  gsub('Model 1', 'Model 10',.)

cat(logit_regtab, sep = "\n")
  

```

