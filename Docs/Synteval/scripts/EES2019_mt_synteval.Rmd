---
title: Summary of Synthetic Variables Estimation 
subtitle: EES 2019 Voter Study (Danish, Estonian, German, Luxembourgian, Maltese, Netherlands, Spanish and British (UK) samples)
author: Wilhelmine Haeussling
date: 15.11.2021 
toc: false
output: 
  bookdown::pdf_document2:
    includes:
      in_header: eval_header.tex
urlcolor: RedOrange
---

```{r echo=FALSE, warning=FALSE, message=FALSE}

# Load 'here' for sourcing # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - #
library('here')

# Source the general workflow # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -#
source(here('Scripts', 'synteval_scripts', 'Synteval_gen.R'))

```

\newpage
# Malta

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Maltese synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval_scripts', 'country_spec_scripts', 'EES2019_mt_synteval.R'))

```

Synthetic variables have been estimated for the full set of Maltese parties (5) available in the original 
2019 EES Maltese voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_mt}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Maltese relevant parties \\label{table:relprty_tab_mt}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_mt}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that in 0 cases out of 5 null models perform better than full ones (see Table 
\ref{table:ols_aic_mt}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_mt}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, three out of five logistic regression models (see Table \ref{table:full_logit_mt}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 8a: D8_rec, EDU_rec, D1_rec, D7_rec (only for category 2), D6_une;
* Model 9a: D8_rec, D7_rec (for category 1 and 2), D6_une;
* Model 10a: D8_rec, EDU_rec (only for category 3), D7_rec (only for category 2), D6_une.

Models 8a, 9a and 10a constant terms and other regression coefficients are affected by the above mentioned variables' inflated standard error showing unusual values.

Model 8a inflated standard errors are due to separation issues. In short, no respondents from rural areas, with low education, with high subjective social status, members of trade unions, and unemployed did vote for party 1903 (see Tables \ref{table:crosstab_3_1_mt}, \ref{table:crosstab_3_2_mt}, \ref{table:crosstab_3_3_mt}, \ref{table:crosstab_3_4_mt}, \ref{table:crosstab_3_5_mt}, \ref{table:crosstab_3_6_mt}).

Model 9a inflated standard errors are due to separation issues. In short, no respondents from rural areas, with NA in their subjective social status and NA in their employment information did vote for party 1904 (see Tables \ref{table:crosstab_4_1_mt}, \ref{table:crosstab_4_2_mt}, \ref{table:crosstab_4_3_mt}). 

Model 10a inflated standard errors are due to separation issues. In short, no respondents from rural areas, with high education or NA in their education information, with high subjective social status, members of trade unions, and unemployed or NA in their employment information did vote for party 1905 (see Tables \ref{table:crosstab_5_1_mt}, \ref{table:crosstab_5_2_mt}, \ref{table:crosstab_5_3_mt}, \ref{table:crosstab_5_4_mt}).

As a consequence, constrained versions of model 8, 9 and 10 (namely, Model 8b, 9b and 10b) without said variables were estimated and contrasted with the originals (Model 8a, 9a and 10a), full model. 

For model 8 Likelihood-ratio test results show that $H_0$ (namely, that the constrained model fits better than the full model) is rejected (see Table \ref{table:lrtest_1_mt}). Consequently, synthetic variables for respondents' vote choice for party 1903 have been predicted relying on the unconstrained model (Model 8a). 

For model 9 Likelihood-ratio test results show that $H_0$ (namely, that the constrained model fits better than the full model) can not be rejected (see Table \ref{table:lrtest_2_mt}). Consequently, synthetic variables for respondents' vote choice for party 1904 have been predicted relying on the constrained model (Model 9b). 

For model 10 Likelihood-ratio test results show that $H_0$ (namely, that the constrained model fits better than the full model) can not be rejected (see Table \ref{table:lrtest_3_mt}). Consequently, synthetic variables for respondents' vote choice for party 1905 have been predicted relying on the constrained model (Model 10b). 

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst3[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 8a (Unconstrained) and Model 8b                               (Constrained)
                  \\label{table:lrtest_1_mt}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

anova_lst4[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 9a (Unconstrained) and Model 9b                               (Constrained)
                  \\label{table:lrtest_2_mt}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

anova_lst5[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 10a (Unconstrained) and Model 10b                               (Constrained)
                  \\label{table:lrtest_3_mt}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in 2 cases out of 5 null models perform better than full ones. According to AIC values the related null model appears to have a better fit than Model 9b and 10b (see Table \ref{table:logit_aic_mt}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[5,1] <- 'stack_1904*'
logit_aic[7,1] <- 'stack_1905*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_mt}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to Model 9b for 1904* (constrained) and to Model 10b for 1905* (constrained).',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs3[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1903 and respondents' area of                       residency 
                   \\label{table:crosstab_3_1_mt}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs3[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1903 and respondents' education                   \\label{table:crosstab_3_2_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs3[[3]] %>% 
  kable(caption ="Cross tabulation between vote choice for party 1903 and respondents' subjective                     SES
                   \\label{table:crosstab_3_3_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs3[[4]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1903 and respondents' trade union 
                   membership \\label{table:crosstab_3_4_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs3[[5]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1903 and respondents' employment                     status 
                  \\label{table:crosstab_3_5_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))



tabs4[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1904 and respondents' area of residency 
                   \\label{table:crosstab_4_1_mt}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs4[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1904 and respondents' subjective SES 
                   \\label{table:crosstab_4_2_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs4[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1904 and respondents' employment status 
                  \\label{table:crosstab_4_3_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))



tabs5[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1905 and respondents' area of residency 
                   \\label{table:crosstab_5_1_mt}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs5[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1905 and respondents' education 
                   \\label{table:crosstab_5_2_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs5[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1905 and respondents' subjective SES 
                   \\label{table:crosstab_5_3_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs5[[4]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1905 and respondents' trade union 
                   membership \\label{table:crosstab_5_4_mt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

```


```{r, results='asis', echo=F}

stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_mt',
                     type = 'latex',
                     column.labels = c('1901', '1902', '1903', '1904','1905'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps')

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_mt',
                       type = 'latex',
                       column.labels = c('1901', '1902', '1903', '1904','1905'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 7', 'Model 10b',.) %>% 
  gsub('Model 6', 'Model 10a',.) %>% 
  gsub('Model 5', 'Model 9b',.) %>% 
  gsub('Model 4', 'Model 9a',.) %>% 
  gsub('Model 3', 'Model 8',.) %>% 
  gsub('Model 2', 'Model 7',.)  %>% 
  gsub('Model 1', 'Model 6',.)

cat(logit_regtab, sep = "\n")
  

```





