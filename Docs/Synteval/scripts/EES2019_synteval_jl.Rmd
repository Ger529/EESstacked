---
title: Summary of Synthetic Variables Estimation 
subtitle: EES 2019 Voter Study (Czech, Finnish, Greek, Hungarian, Lithuanian, Slovakian, Polish and Swedish Samples)
author: Julian Leiser
date: 05.04.2022 
toc: false
output: 
  bookdown::pdf_document2:
    includes:
      in_header: eval_header.tex
urlcolor: RedOrange
---


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide'}

# Load 'here' for sourcing # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - #
library('here')

# Source the general workflow # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -#
source(here('Scripts', 'synteval', 'Synteval_gen.R'))

```

\newpage
# Czech Republic

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Czech Rep. synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_cz_synteval.R'))

```

Synthetic variables have been estimated for the full set of Czech parties available in the original 
2019 EES Czech Republic voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_cz}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Czech Republic relevant parties \\label{table:relprty_tab_cz}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_cz}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in all cases (see Table \ref{table:ols_aic_cz}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_cz}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, five out of eight logistic regression models (see Table \ref{table:full_logit_cz}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 9: D6_une
* Model 10a: EDU_rec (both categories), D7_rec (second category), D6_une
* Model 11: D6_une
* Model 15: D6_une
* Model 16: D6_une

However, for models 9, 11, 15 and 16 the constant terms and other regressors are not affected by the inflated standard errors. Model 10a appears more problematic.

The inflated standard errors in Model 10a are due to separation issues. In short, no respondents who are unemployed or of high subjective social status did vote for party 603. Only one respondent with low education voted for party 603. (See tables \ref{table:crosstab_1_cz}, \ref{table:crosstab_2_cz}, \ref{table:crosstab_3_cz})

As a consequence, a constrained version of model 10 (namely, Model 10b) without said variables was 
estimated and contrasted with the original (Model 10a), full model. Likelihood-ratio test results show 
that $H_0$ (namely, that the constrained model fits better than the full model) cannot be rejected 
(see Table \ref{table:lrtest_1_cz}). Consequently, synthetic variables for respondents' vote choice for 
party 603 have been predicted relying on the constrained model (Model 10b).

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 10a (Unconstrained) and Model 10b (Constrained)
                  \\label{table:lrtest_1_cz}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in four cases out of eight null models perform better than full ones. According to AIC 
values the related null model appears to have a better fit than Model 10b (see Table \ref{table:logit_aic_cz}). 


```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[4,1] <- 'stack_603*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_cz}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to Model 10b (constrained).',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 603 and respondents' education 
                   \\label{table:crosstab_1_cz}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 603 and respondents' subjective social class
                   \\label{table:crosstab_2_cz}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 603 and respondents' employment status 
                   \\label{table:crosstab_3_cz}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))



```

```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_cz',
                     type = 'latex',
                     column.labels = c('601', '603', '604', '605','606', '607', '608', '602'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_cz',
                       type = 'latex',
                       column.labels = c('601', '603', '603', '604', '605','606', '607', '608', '602'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 2', 'Model 10a',.) %>% 
  gsub('Model 3', 'Model 10b',.) %>% 
  gsub('Model 4', 'Model 11',.) %>% 
  gsub('Model 5', 'Model 12',.) %>% 
  gsub('Model 6', 'Model 13',.) %>% 
  gsub('Model 7', 'Model 14',.) %>% 
  gsub('Model 8', 'Model 15',.) %>% 
  gsub('Model 9', 'Model 16',.) %>%
  sub('Model 1', 'Model 9',.) 



cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```

\newpage
# Finland

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Finland synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_fi_synteval.R'))

```

Synthetic variables have been estimated for the full set of Finnish parties available in the original 
2019 EES Finland voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_fi}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Finland relevant parties \\label{table:relprty_tab_fi}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_fi}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in all cases (see Table \ref{table:ols_aic_fi}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_fi}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

Similarly, only one out of the seven logistic regression models (see Table \ref{table:full_logit_fi}) shows 
inflated standard errors for one of the coefficients of interest, in particular: 

* Model 11: D6_une

However, the constant term and the other regressors of model 11 seem not to be affected by the inflated standard errors. Thus, no further adjustments are made and model 11 is kept as is. 

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in two cases out of seven null models perform better than full ones (see Table \ref{table:logit_aic_fi}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_fi}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) 

```

```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_fi',
                     type = 'latex',
                       column.labels = c('1001', '1002', '1003', '1004', '1005', '1006', '1007'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_fi',
                       type = 'latex',
                       column.labels = c('1001', '1002', '1003', '1004', '1005', '1006', '1007'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 2', 'Model 9',.) %>% 
  gsub('Model 3', 'Model 10',.) %>% 
  gsub('Model 4', 'Model 11',.) %>% 
  gsub('Model 5', 'Model 12',.) %>% 
  gsub('Model 6', 'Model 13',.) %>% 
  gsub('Model 7', 'Model 14',.) %>% 
  sub('Model 1', 'Model 8',.) 

cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```


\newpage
# Greece

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Greece synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_el_synteval.R'))

```

Synthetic variables have been estimated for the full set of Greek parties available in the original 
2019 EES Greece voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_el}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Greece relevant parties \\label{table:relprty_tab_el}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_el}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in all cases (see Table \ref{table:ols_aic_el}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_el}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, two out of five logistic regression models (see Table \ref{table:full_logit_el}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 8a: EDU_rec (both categories), D1_rec
* Model 9: D7_rec (second category)

However, for model 9 the constant term and other regressors are not affected by the inflated standard errors. Model 8a appears more problematic.

The inflated standard errors in Model 8a are potentially due to separation issues. In short, no respondents with low education voted for party 1203 and only two respondents who were union members voted for party 1203. (See Tables \ref{table:crosstab_1_el}, \ref{table:crosstab_2_el})

As a consequence, a constrained version of model 8 (namely, Model 8b) without said variables was 
estimated and contrasted with the original (Model 8a), full model. Likelihood-ratio test results show 
that $H_0$ (namely, that the constrained model fits better than the full model) can be rejected 
(see Table \ref{table:lrtest_1_el}). Consequently, synthetic variables for respondents' vote choice for 
party 1203 have been predicted relying on the unconstrained model (Model 8a).

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 8a (Unconstrained) and Model 8b (Constrained)
                  \\label{table:lrtest_1_el}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in one case out of five the null model performs better than the full ones. According to AIC 
values the related null model appears to have a better fit than Model 8b (see Table \ref{table:logit_aic_el}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[4,1] <- 'stack_1203*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_el}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to Model 8b (constrained).',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1203 and respondents' education level
                   \\label{table:crosstab_1_el}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1203 and respondents' trade union membership status
                   \\label{table:crosstab_2_el}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))




```

```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents'
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_el',
                     type = 'latex',
                     column.labels = c('1201','1202', '1203', '1204', '1205'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_el',
                       type = 'latex',
                       column.labels = c('1201','1202', '1203', '1203', '1204', '1205'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 2', 'Model 7',.) %>% 
  gsub('Model 3', 'Model 8a',.) %>% 
  gsub('Model 4', 'Model 8b',.) %>% 
  gsub('Model 5', 'Model 9',.) %>% 
  gsub('Model 6', 'Model 10',.) %>% 
  sub('Model 1', 'Model 6',.) 



cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```

\newpage
# Hungary

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Hungary synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_hu_synteval.R'))

```

Synthetic variables have been estimated for the full set of Hungarian parties available in the original 
2019 EES Hungary voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_hu}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Hungary relevant parties \\label{table:relprty_tab_hu}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_hu}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in all cases (see Table \ref{table:ols_aic_hu}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_hu}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, three out of seven logistic regression models (see Table \ref{table:full_logit_hu}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 11: D7_rec (second category)
* Model 12: D6_une
* Model 13: D7_rec (second category), D6_une

However, for these models the constant terms and other regressors are not affected by the inflated standard errors. Thus, no additional adjustments are made and models 11, 12 and 13 are not modified.

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in three cases out of seven null models perform better than full ones (see Table \ref{table:logit_aic_hu}).. 


```{r echo=FALSE, warning=FALSE, message=FALSE}

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_hu}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```



```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_hu',
                     type = 'latex',
                     column.labels = c('1301', '1302', '1303', '1304','1306', '1307', '1308'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_hu',
                       type = 'latex',
                       column.labels = c('1301', '1302', '1303', '1304','1306', '1307', '1308'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 2', 'Model 9',.) %>% 
  gsub('Model 3', 'Model 10',.) %>% 
  gsub('Model 4', 'Model 11',.) %>% 
  gsub('Model 5', 'Model 12',.) %>% 
  gsub('Model 6', 'Model 13',.) %>% 
  gsub('Model 7', 'Model 14',.) %>% 
  sub('Model 1', 'Model 8',.) 



cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```

\newpage
# Lithuania

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Lithuania synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_lt_synteval.R'))

```

Synthetic variables have been estimated for the full set of Lithuanian parties available in the original 
2019 EES Lithuania voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_lt}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Lithuania relevant parties \\label{table:relprty_tab_lt}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_lt}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in six out of seven cases (see Table \ref{table:ols_aic_lt}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_lt}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, three out of seven logistic regression models (see Table \ref{table:full_logit_lt}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 10a: EDU_rec (both categories)
* Model 13a: EDU_rec (both categories), D7_rec (second category), D6_une
* Model 14a: EDU_rec (both categories)

Models 10a, 13a and 14a are all problematic as the constant terms seem to be affected by the inflated standard errors issue. These inflated standard errors are due to separation issues which are explored below.

For Model 10a, we see that no respondent with low education voted for party 1706 (see Table \ref{table:crosstab_1_lt}).
For Model 13a, we have that again no respondent with low education and no respondent who is unemployed voted for party 1707 (see Tables \ref{table:crosstab_2_lt}, \ref{table:crosstab_4_lt}). Furthermore, only one respondent with high subjective social class voted for party 1707 (see Table \ref{table:crosstab_3_lt}).
Finally, for Model 14a Table \ref{table:crosstab_5_lt} shows that no respondent with low education voted for party 1702.

As a consequence constrained versions of Models  10, 13 and 14 (namely 10b, 13b and 14b) were estimated. In Models 10b and 14b the EDU_rec variables were removed, while in Model 13b the EDU_rec variables, the D7_rec variables and the D6_une variable were removed. These constrained models were then contrasted with their respective (original) full models (i.e. 10a, 13a, 14a). Likelihood-ratio test results show that $H_0$ (constrained model fits better than the full model) cannot be rejected for any of the models (see Tables \ref{table:lrtest_1_lt}, \ref{table:lrtest_2_lt}, \ref{table:lrtest_3_lt}). Following these results, synthetic variables for respondents' vote choice for parties 1706, 1707 and 1702 have been predicted relying on the constrained models (Model 10b, 13b, 14b).

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst3[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 10a (Unconstrained) and Model 10b (Constrained)
                  \\label{table:lrtest_1_lt}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst6[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 13a (Unconstrained) and Model 13b (Constrained)
                  \\label{table:lrtest_2_lt}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst7[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 14a (Unconstrained) and Model 14b (Constrained)
                  \\label{table:lrtest_3_lt}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in two cases out of seven null models perform better than full ones. According to AIC 
values the related null models appear to have a worse fit than Models 10b, 13b and 14b (see Table \ref{table:logit_aic_lt}). 


```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[3,1] <- 'stack_1702*'
logit_aic[8,1] <- 'stack_1706*'
logit_aic[10,1] <- 'stack_1707*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_lt}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to constrained models (i.e. 14b, 10b, 13b)',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs3[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1706 and respondents' education 
                   \\label{table:crosstab_1_lt}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs6[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1707 and respondents' education
                   \\label{table:crosstab_2_lt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs6[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1707 and respondents' subjective social class
                   \\label{table:crosstab_3_lt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs6[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1707 and respondents' employment status
                   \\label{table:crosstab_4_lt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs7[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 1702 and respondents' education
                   \\label{table:crosstab_5_lt}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))



```

```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_lt',
                     type = 'latex',
                     column.labels = c('1701', '1703', '1706', '1705','1704', '1707', '1702'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_lt',
                       type = 'latex',
                     column.labels = c('1701', '1703', '1706', '1706', '1705','1704', '1707', '1707', '1702', '1702'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  sub('\\\\\\[-1.8ex]','textbf{Model}',.) %>%
  gsub('Model 9', '14a',.) %>%
  gsub('Model 2', '9',.) %>%
  gsub('Model 10', '14b',.) %>%
  sub('Model 3', '10a',.) %>% 
  sub('Model 4', '10b',.) %>% 
  sub('Model 5', '11',.) %>% 
  sub('Model 6', '12',.) %>% 
  sub('Model 7', '13a',.) %>% 
  sub('Model 8', '13b',.) %>% 
  sub('Model 1', '8',.) 



cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```

\newpage
# Slovakia

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Slovakia synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_sk_synteval.R'))

```

Synthetic variables have been estimated for the full set of Slovakian parties available in the original 
2019 EES Slovakia voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_sk}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Slovakia relevant parties \\label{table:relprty_tab_sk}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_sk}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in eight out of nine cases (see Table \ref{table:ols_aic_sk}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_sk}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, two out of nine logistic regression models (see Table \ref{table:full_logit_sk}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 15: D6_une
* Model 18a: EDU_rec (both categories), D1_rec, D6_une

However, for model 15 the constant term and other regressors are not affected by the inflated standard errors. Model 18a appears more problematic.

The inflated standard errors in Model 18a are due to separation issues. In short, no respondents with low education voted for party 2507. Furthermore, only one respondent with trade union membership status and only one repondent who is unemployed vote for party 2507. (See tables \ref{table:crosstab_1_sk}, \ref{table:crosstab_2_sk}, \ref{table:crosstab_3_sk})

As a consequence, a constrained version of model 18 (namely, Model 18b) without said variables was 
estimated and contrasted with the original (Model 18a), full model. Likelihood-ratio test results show 
that $H_0$ (namely, that the constrained model fits better than the full model) cannot be rejected 
(see Table \ref{table:lrtest_1_sk}). Consequently, synthetic variables for respondents' vote choice for 
party 2507 have been predicted relying on the constrained model (Model 18b).

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 18a (Unconstrained) and Model 18b (Constrained)
                  \\label{table:lrtest_1_sk}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in six cases out of nine null models perform better than full ones. According to AIC 
values the related null model appears to have a better fit than Model 18b (see Table \ref{table:logit_aic_sk}). 


```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[7,1] <- 'stack_2507*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_sk}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to Model 18b (constrained).',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 2507 and respondents' education 
                   \\label{table:crosstab_1_sk}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 2507 and respondents' trade union membership status
                   \\label{table:crosstab_2_sk}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 2507 and respondents' employment status 
                   \\label{table:crosstab_3_sk}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))



```

```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_sk',
                     type = 'latex',
                     column.labels = c('2510', '2501', '2509', '2503', '2505', '2506', '2508', '2504', '2507'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_sk',
                       type = 'latex',
                       column.labels = c('2510', '2501', '2509', '2503', '2505', '2506', '2508', '2504', '2507',                        '2507'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  sub('\\\\\\[-1.8ex]','textbf{Model}',.) %>%
  gsub('Model 10', '18b',.) %>%
  sub('Model 1', '10',.) %>%
  gsub('Model 2', '11',.) %>% 
  gsub('Model 3', '12',.) %>% 
  gsub('Model 4', '13',.) %>% 
  gsub('Model 5', '14',.) %>% 
  gsub('Model 6', '15',.) %>% 
  gsub('Model 7', '16',.) %>% 
  gsub('Model 8', '17',.) %>% 
  gsub('Model 9', '18a',.)





cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```

\newpage
# Poland

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Poland synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_pl_synteval.R'))

```

Synthetic variables have been estimated for the full set of Polish parties available in the original 
2019 EES Poland voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_pl}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Poland relevant parties \\label{table:relprty_tab_pl}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_pl}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in all cases (see Table \ref{table:ols_aic_pl}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_pl}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, one out of the five logistic regression models (see Table \ref{table:full_logit_pl}) shows
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 9a: EDU_rec (both categories), D7_rec (second category), D6_une

Model 9a appears to be problematic as the constant term seems to be affected by the inflated standard errors issue.

The inflated standard errors in Model 9a are due to separation issues. In short, no respondents who are unemployed or of high subjective social status voted for party 2105. Only one respondent with low education voted for party 2105. (See tables \ref{table:crosstab_1_pl}, \ref{table:crosstab_2_pl}, \ref{table:crosstab_3_pl})

As a consequence, a constrained version of model 9 (namely, Model 9b) without said variables was 
estimated and contrasted with the original (Model 9a), full model. Likelihood-ratio test results show 
that $H_0$ (namely, that the constrained model fits better than the full model) cannot be rejected 
(see Table \ref{table:lrtest_1_pl}). Consequently, synthetic variables for respondents' vote choice for 
party 2105 have been predicted relying on the constrained model (Model 9b).

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 9a (Unconstrained) and Model 9b (Constrained)
                  \\label{table:lrtest_1_pl}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in one case out of five null models perform better than full ones. According to AIC 
values the related null model appears to have a better fit than Model 9b (see Table \ref{table:logit_aic_pl}). 


```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[5,1] <- 'stack_2105*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_pl}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to Model 9b (constrained).',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 2105 and respondents' education 
                   \\label{table:crosstab_1_pl}", booktabs = F) %>%  #  align = c('l', 'c', rep('r',3))
  kable_styling(latex_options = c('striped'))

tabs[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 2105 and respondents' subjective social class
                   \\label{table:crosstab_2_pl}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 2105 and respondents' employment status 
                   \\label{table:crosstab_3_pl}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))



```

```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_pl',
                     type = 'latex',
                     column.labels = c('2104', '2106', '2102', '2105', '2103'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_pl',
                       type = 'latex',
                       column.labels = c('2104', '2106', '2102', '2105', '2105', '2103'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%

  gsub('Model 2', 'Model 7',.) %>% 
  gsub('Model 3', 'Model 8',.) %>% 
  gsub('Model 4', 'Model 9a',.) %>% 
  gsub('Model 5', 'Model 9b',.) %>% 
  gsub('Model 6', 'Model 10',.) %>%
  sub('Model 1', 'Model 6',.)
  

cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```

\newpage
# Sweden

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Sweden synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval', 'country_spec', 'EES2019_se_synteval.R'))

```

Synthetic variables have been estimated for the full set of Swedish parties available in the original 
2019 EES Sweden voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_se}).

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Sweden relevant parties \\label{table:relprty_tab_se}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_se}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that the full models perform better in all cases (see Table \ref{table:ols_aic_se}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_se}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, one out of the eight logistic regression models (see Table \ref{table:full_logit_se}) shows 
inflated standard errors for one of the coefficients of interest, in particular: 

* Model 10: D6_une

However, the constant term and the other regressors of Model 10 are not affected by the inflated standard errors issue. Therefore, no additional adjustments are made and Model 10 is kept as is.

In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in three cases out of eight null models perform better than full ones (see Table \ref{table:logit_aic_se}). 


```{r echo=FALSE, warning=FALSE, message=FALSE}


names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_se}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) 

```



```{r, results='asis', echo=F}

ols_regtab <-
stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_se',
                     type = 'latex',
                     column.labels = c('2702', '2705', '2707', '2704', '2703', '2708', '2706', '2701'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps') %>%
capture.output() 
cat("\\blandscape", ols_regtab, "\\elandscape", sep = "\n")

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_se',
                       type = 'latex',
                       column.labels = c('2702', '2705', '2707', '2704', '2703', '2708', '2706', '2701'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 2', 'Model 10',.) %>% 
  gsub('Model 3', 'Model 11',.) %>% 
  gsub('Model 4', 'Model 12',.) %>% 
  gsub('Model 5', 'Model 13',.) %>% 
  gsub('Model 6', 'Model 14',.) %>% 
  gsub('Model 7', 'Model 15',.) %>% 
  gsub('Model 8', 'Model 16',.) %>% 
  sub('Model 1', 'Model 9',.) 



cat("\\blandscape", logit_regtab, "\\elandscape", sep = "\n")
  

```
