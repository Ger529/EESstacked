---
title: Summary of Synthetic Variables Estimation 
subtitle: EES 2019 Voter Study (Danish, Estonian, German, Luxembourgian, Maltese, Netherlands, Spanish and British (UK) samples)
author: Wilhelmine Haeussling
date: 15.11.2021 
toc: false
output: 
  bookdown::pdf_document2:
    includes:
      in_header: eval_header.tex
urlcolor: RedOrange
---

```{r echo=FALSE, warning=FALSE, message=FALSE}

# Load 'here' for sourcing # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - #
library('here')

# Source the general workflow # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -#
source(here('Scripts', 'synteval_scripts', 'Synteval_gen.R'))

```

\newpage
# Estonia

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Source the Estonian synteval script # - - - - - - - - - - - - - - - - - - - - - - - - - #

source(here('Scripts', 'synteval_scripts', 'country_spec_scripts', 'EES2019_ee_synteval.R'))

```

Synthetic variables have been estimated for seven of twelve Estonian parties available in the original 
2019 EES Estonian voter study selected according to the criteria stated in the EES 2019 SDM codebook (
for the criteria see Sect. XXX; for the relevant parties see Table \ref{table:relprty_tab_ee}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}
options(knitr.kable.NA = 'NA')
options(knitr.table.format = "latex")

names(relprty_df) <- c('Dep. Var.', 'Party', 'Party name (eng)')

relprty_df %>% 
  kable(caption = "Estonian relevant parties \\label{table:relprty_tab_ee}", booktabs = T, 
        align = c('l', 'c', 'l')) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

Full OLS models converge and coefficients do not show any particular issue (see Table 
\ref{table:full_ols_ee}). 
In terms of model fit, the adjusted coefficient of determination ($R^2$) values vary between 
a minimum value of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['Adj_Rsq']]` 
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partycode']]` 
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==min(Adj_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['Adj_Rsq']]`
for party `r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partycode']]`
(`r ols_df %>% filter(model=='full') %>% filter(Adj_Rsq==max(Adj_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for full OLS models and null 
models shows that in 0 cases out of 7 null models perform better than full ones (see Table 
\ref{table:ols_aic_ee}).

```{r echo=FALSE, warning=FALSE, message=FALSE}


names(ols_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

ols_aic %>% 
  kable(caption = "Akaike Information Criterion values for OLS full and null models 
        \\label{table:ols_aic_ee}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))


```

On the contrary, three out of seven logistic regression models (see Table \ref{table:full_logit_ee}) show 
inflated standard errors for some of the coefficients of interest, in particular: 

* Model 9: D6_une;
* Model 13a: EDU_rec;
* Model 14a: D5_rec, EDU_rec, D1_rec, D6_une.
 
Nevertheless, model's 9 constant terms and other regression coefficients are not affected by said inflated standard errors, whereas model 13a and 14a present a more problematic profile. 

Model 13a's and 14a's inflated standard errors are due to separation issues. In short, no respondents from respondents with low education did vote for party 906 (see Table \ref{table:crosstab_1_ee}) and no respondents with low education, with high subjective social status, no members of trade unions, and unemployed and only very few respondents married or in partnership as well as married or in a partnership (2 and 9) did vote for party 907 
(see Tables \ref{table:crosstab_2_ee}, \ref{table:crosstab_3_ee}, \ref{table:crosstab_4_ee}, 
\ref{table:crosstab_5_ee}).

As a consequence, a constrained version of model 13 (namely, Model 13b) without said variable was 
estimated and contrasted with the original (Model 13a), full model. Likelihood-ratio test results show 
that $H_0$ (namely, that the constrained model fits better than the full model) cannot be rejected 
(see Table \ref{table:lrtest_1_ee}). Consequently, synthetic variables for respondents' vote choice for 
party 906 have been predicted relying on the constrained model (Model 13b). 

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst6[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 13a (Unconstrained) and Model 13b (Constrained)
                  \\label{table:lrtest_1_ee}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```

In \ref{table:crosstab_2_ee} there is no 0 disrupting our logit regression. As a consequence, a constrained version of model 14 (namely, Model 14b_1) without said variables and without D5_rec was 
estimated and contrasted with the original (Model 14a), full model. 
Likelihood-ratio test results show that $H_0$ (namely, that the constrained model fits better than the full model) cannot be rejected (see Table \ref{table:lrtest_2_ee}). 

Furthermore, another constrained version of model 14 (namely, Model 14b_2) without said variables, but with D5_rec, was estimated and contrasted with the original (Model 14a), full model.
Model 14b_2 is therefore less constrained than 14b_1 (by D5_rec).
Likelihood-ratio test results show that $H_0$ (namely, that the constrained model fits better than the full model) cannot be rejected (see Table \ref{table:lrtest_3_ee}). 

Then we compared the fit of 14b_1 and 14b_2. Likelihood-ratio test results show that $H_0$ (namely, that the constrained model without D5_rec fits better than the fuller constrained model with D5_rec) cannot be rejected (see Table \ref{table:lrtest_3_ee}). Consequently, synthetic variables for respondents' vote choice for party 907 have been predicted relying on the more constrained model without D5_rec (Model 14b_2).

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = '')

anova_lst7_1[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 14a (Unconstrained) and Model 14b_1 (Constrained and without D5_rec)
                  \\label{table:lrtest_2_ee}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

anova_lst7_2[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 14a (Unconstrained) and Model 14b_2 (Constrained and with D5_rec)
                  \\label{table:lrtest_3_ee}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

anova_lst7_1vs2[[1]] %>%
  kable(caption = "Likelihood-ratio Test between Model 14b_1 (Constrained and without D5_rec, here: Constrained) and Model 14b_2 (Constrained and with D5_rec, here Unconstrained)
                  \\label{table:lrtest_4_ee}", booktabs = F, ) %>% 
  kable_styling(latex_options = c('striped', 'hold_position'))

```


In terms of model fit, adjusted McFadden's pseudo $R^2$ values for the logistic full models vary between 
a minimum value of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)` 
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partycode']]` 
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==min(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`) 
and a maximum of 
`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['Adj_Ps_Rsq']] %>% round(.,3)`
for party `r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partycode']]`
(`r logit_df %>% filter(model=='full') %>% filter(Adj_Ps_Rsq==max(Adj_Ps_Rsq)) %>% .[['partyname_eng']]`). 
Moreover, the difference between Akaike Information Criterion (AIC) values for logistic full models and 
null models shows that in 3 cases out of 7 null models perform better than full ones. According to AIC 
values the related null model appears to have a better fit than Model 13b and 14b_2 (see Table
\ref{table:logit_aic_ee}). 

```{r echo=FALSE, warning=FALSE, message=FALSE}

logit_aic[7,1] <- 'stack_906*'
logit_aic[9,1] <- 'stack_907*'

names(logit_aic) <- c('Dep. Var.', 'Party', 'Full Mod.', 'Null Mod.', 'Diff. (Full-Null)')

logit_aic %>% 
  kable(caption = "Akaike Information Criterion values for logistic full and null models 
        \\label{table:logit_aic_ee}", booktabs = T, 
        align = c('l', 'c', rep('r',3))) %>% 
  kable_styling(latex_options = c('striped', 'hold_position')) %>% 
  footnote(symbol = 'AIC value refers to Model 13b for 906* (constrained) and 14b_2 for 907* (constrained and with D5_rec).',
           threeparttable = T,
           footnote_as_chunk = T)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.kable.NA = 'NA')

tabs6[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 906 and respondents' education 
                   \\label{table:crosstab_1_ee}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs7[[1]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 907 and respondents' marital status
                   \\label{table:crosstab_2_ee}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs7[[2]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 907 and respondents' education 
                   \\label{table:crosstab_3_ee}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs7[[3]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 907 and respondents' trade union 
                   membership \\label{table:crosstab_4_ee}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

tabs7[[4]] %>% 
  kable(caption = "Cross tabulation between vote choice for party 907 and respondents' employment status 
                  \\label{table:crosstab_5_ee}", booktabs = F) %>% 
  kable_styling(latex_options = c('striped'))

```


```{r, results='asis', echo=F}

stargazer::stargazer(finalmod_lst$OLS, 
                     title = "Propensity to vote for a relevant party according to respondents' 
                     socio-demographic characteristics (OLS regression models)",
                     label = 'table:full_ols_ee',
                     type = 'latex',
                     column.labels = c('901', '902', '903', '904','905', '906', '907'),
                     dep.var.labels.include = F,
                     star.cutoffs = c(0.05, 0.01, 0.001),
                     omit.stat=c("f", "ser"),
                     header = F,
                     style = 'ajps')

logit_regtab <- 
  stargazer::stargazer(finalmod_lst$logit, 
                       title = "Vote choice for a relevant party according to respondents' 
                       socio-demographic characteristics (Logistic regression models)",
                       label = 'table:full_logit_ee',
                       type = 'latex',
                       column.labels = c('901', '902', '903', '904','905','906','906','907', '907'),
                       dep.var.labels.include = F,
                       star.cutoffs = c(0.05, 0.01, 0.001),
                       omit.stat=c("f", "ser"),
                       header = F,
                       style = 'ajps') %>% 
  capture.output() 

logit_regtab[9] %<>%
  gsub('Model 9', 'Model 14b_2',.) %>% 
  gsub('Model 8', 'Model 14a',.) %>% 
  gsub('Model 7', 'Model 13b',.)%>% 
  gsub('Model 6', 'Model 13a',.) %>% 
  gsub('Model 5', 'Model 12',.) %>% 
  gsub('Model 4', 'Model 11',.) %>% 
  gsub('Model 3', 'Model 10',.) %>% 
  gsub('Model 2', 'Model 9',.)  %>% 
  gsub('Model 1', 'Model 8',.)

cat(logit_regtab, sep = "\n")
  

```


